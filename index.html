<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="color-scheme" content="light dark">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WJU Derivation</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.time-pack.com/fonts/fonts.css">
  <script src="https://cdn.bootcdn.net/ajax/libs/vue/3.5.20/vue.global.prod.js"></script>
</head>
<body>
  <article id="app" class="flex flex-col h-full">
    <header class="text-center py-5">
      <h1>WJU Derivation</h1>
      <sub class="text-sm">{{ cost }} points</sub>
    </header>
    <main class="flex-1 flex flex-col justify-center items-center">
      <section v-if="current">
        <span class="text-[5em]" v-for="(t, i) in current.split('')" :key="t + i">{{ t }}</span>
      </section>
      <section v-if="!current">
        <button @click="startGame" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
          开始游戏 (100 points)
        </button>
      </section>
      <section v-else>
        <button 
          @click="addJ" 
          class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded m-2 disabled:bg-gray-500 disabled:cursor-not-allowed" 
          :disabled="!canAddJ">
          + J
        </button>
        <button 
          @click="addU" 
          class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded m-2 disabled:bg-gray-500 disabled:cursor-not-allowed" 
          :disabled="!canAddU">
          + U
        </button>
        <button
          @click="double" 
          class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded m-2 disabled:bg-gray-500 disabled:cursor-not-allowed">
          Wx => Wxx
        </button>
        <button
          @click="lessJ" 
          class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded m-2 disabled:bg-gray-500 disabled:cursor-not-allowed" 
          :disabled="!canLessJ">
          JJJ => U
        </button>
        <button
          @click="lessU" 
          class="bg-purple-500 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded m-2 disabled:bg-gray-500 disabled:cursor-not-allowed"
          :disabled="!canLessU">
          UU => J
        </button>
      </section>
      <section v-if="current" class="whitespace-pre-wrap w-full text-center px-5">
        <span 
          class="text-[3em]" 
          :class="{ 'text-blue-500': t != '_', 'text-gray-500': t == '_' }" 
          v-for="(t, i) in matchText.split('')" 
          :key="t + i">
          {{ t }}
        </span>
      </section>
      <section v-if="current" class="flex items-center justify-center">
        <button 
          @click="revoke" 
          title="撤回操作"
          :disabled="!history.length"
          class="disabled:text-gray-500 text-white font-bold py-2 px-4 rounded m-2 font-mono disabled:cursor-not-allowed">
          ↩ (10 points)
        </button>
        <button 
          @click="startGame" 
          title="重新开始"
          class="disabled:text-gray-500 text-white font-bold py-2 px-4 rounded m-2 font-mono">
          ↻ (100 points)
        </button>
      </section>
      <section v-if="help" class="flex flex-col p-5 bg-black bg-opacity-90 rounded-lg shadow-light-100 shadow-lg max-w-[400px] w-full max-h-[700px] h-[96%] fixed top-[2%]">
        <h2 class="text-lg font-bold text-center relative pb-5">
          <span class="font-bold text-lg">How to Play</span>
          <button class="absolute right-0" @click="help = false">X</button>
        </h2>
        <ol class="space-y-2 list-outside list-decimal pl-5 help">
          <li>开始游戏会从一个由 WJU 三个字母生成随机的起始字符串，经过一系列步骤生成一个目标字符串。</li>
          <li>你可以通过点击按钮来执行不同的操作，推导出目标字符串。</li>
          <li>一共有 5 种操作可供选择，分别是：
            <b class="text-green-500">+J</b>、
            <b class="text-yellow-500">+U</b>、
            <b class="text-blue-500">Wx => Wxx</b>、
            <b class="text-red-500">JJJ => U</b> 和 
            <b class="text-purple-500">UU => J</b>。
          </li>
          <li>不同操作都有其可执行的条件，具体如下：
            <ul class="p-5 list-disc list-outside space-y-1">
              <li><b class="text-green-500">+J</b>：结尾不是 <code>JJ</code> 时可用，执行后在字符串末尾添加一个 J。</li>
              <li><b class="text-yellow-500">+U</b>：结尾不是 <code>UUU</code> 时可用，执行后在字符串末尾添加一个 U。</li>
              <li><b class="text-blue-500">Wx => Wxx</b>：始终可用，执行后将字符串翻倍（例如 WJU 变为 WJUJU）。</li>
              <li><b class="text-red-500">JJJ => U</b>：当字符串中包含 <code>JJJ</code> 时可用，执行后将 <code>JJJ</code> 替换为 U。</li>
              <li><b class="text-purple-500">UU => J</b>：当字符串中包含 <code>UU</code> 时可用，执行后将 <code>UU</code> 替换为 J。</li>
            </ul>
          </li>
          <li>完成推导将会奖励 500 积分，撤回操作将会消耗 10 积分。</li>
        </ol>
      </section>
    </main>
    <footer class="text-center space-y-2 py-5">
      <p><a href="javascript:void(0)" @click="help = !help">Need help?</a></p>
      <p class="text-center">© 2025 WJU Derivation. All rights reserved.</p>
    </footer>
  </article>
  <link rel="stylesheet" href="assets/style.css" />
  <script src="assets/core.js"></script>
  <script src="assets/main.js"></script>
</body>
</html>